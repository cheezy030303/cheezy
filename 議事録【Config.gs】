/**
 * 設定ファイル
 * 実際の使用時には、このファイルの値を更新してください
 */

/**
 * アプリケーション全体の設定を返す
 */
function getConfig() {
  return {
    // ============================================
    // カレンダー設定
    // ============================================
    
    // 会社の共有カレンダーのID（複数指定可能）
    // 配列で複数のカレンダーを指定できます
    // 空の場合はデフォルトカレンダーを使用
    CALENDAR_ID: [
      'mtanaka@mirai-kirei.jp',
      'nakamura-h@mirai-kirei.jp',
      'kawamoto-y@mirai-kirei.jp',
      'okumura-h@mirai-kirei.jp',
      'majima-t@mirai-kirei.jp',
      'takano-r@mirai-kirei.jp',
      'hashimoto-k@mirai-kirei.jp',
      'maeno-a@mirai-kirei.jp',
      'tani-s@mirai-kirei.jp',
      'yokoyama-s@mirai-kirei.jp',
      'yoshida-k@mirai-kirei.jp',
      'yoshida-m@mirai-kirei.jp',
      'miyazawa-r@mirai-kirei.jp',
      'arayashiki-r@mirai-kirei.jp',
      'yyamada@mirai-kirei.jp',
      'koike-m@mirai-kirei.jp',
      'ono-h@mirai-kirei.jp',
      'hirata-y@mirai-kirei.jp',
      'taishisuzuki@mirai-kirei.jp',
      'shibuya-s@mirai-kirei.jp',
      'takahashi-r@mirai-kirei.jp',
      'soda-c@mirai-kirei.jp',
      'shimizu-a@mirai-kirei.jp',
      'sugisue-r@mirai-kirei.jp',
      'koga-s@mirai-kirei.jp',
      'senami-y@mirai-kirei.jp',
      'fushimi-m@mirai-kirei.jp',
      'sato-s@mirai-kirei.jp',
      'ito-y@mirai-kirei.jp',
      'shimoji-t@mirai-kirei.jp',
      'kubota-s@mirai-kirei.jp',
      'sato-c@mirai-kirei.jp',
      'sakamoto-m@mirai-kirei.jp',
      'miyake-m@mirai-kirei.jp',
      'yamashita-k@mirai-kirei.jp',
      'yamamoto-y@mirai-kirei.jp',
      'oooke-y@mirai-kirei.jp',
      'hasebe-m@mirai-kirei.jp',
      'uchida-m@mirai-kirei.jp',
      'kusumi-m@mirai-kirei.jp',
      'hiratani-r@mirai-kirei.jp',
      'hirata-k@mirai-kirei.jp',
      'hayashi-a@mirai-kirei.jp',
      'suzuki-y@mirai-kirei.jp'
    ],
    
    // 過去何日分のイベントを取得するか（現在は使用していません。前日のみをチェックします）
    LOOKBACK_DAYS: 7,
    
    // ============================================
    // マーケティング部メンバー設定
    // ============================================
    
    // マーケティング部のメンバーのメールアドレスリスト
    MARKETING_TEAM: [
      'mtanaka@mirai-kirei.jp',
      'nakamura-h@mirai-kirei.jp',
      'kawamoto-y@mirai-kirei.jp',
      'okumura-h@mirai-kirei.jp',
      'majima-t@mirai-kirei.jp',
      'takano-r@mirai-kirei.jp',
      'hashimoto-k@mirai-kirei.jp',
      'maeno-a@mirai-kirei.jp',
      'tani-s@mirai-kirei.jp',
      'ibi-h@mirai-kirei.jp',
      'yokoyama-s@mirai-kirei.jp',
      'yoshida-k@mirai-kirei.jp',
      'yoshida-m@mirai-kirei.jp',
      'miyazawa-r@mirai-kirei.jp',
      'arayashiki-r@mirai-kirei.jp',
      'yyamada@mirai-kirei.jp',
      'koike-m@mirai-kirei.jp',
      'ono-h@mirai-kirei.jp',
      'hirata-y@mirai-kirei.jp',
      'taishisuzuki@mirai-kirei.jp',
      'shibuya-s@mirai-kirei.jp',
      'takahashi-r@mirai-kirei.jp'
    ],
    
    // パートメンバーのメールアドレスリスト
    PART_TIMER_TEAM: [
      'soda-c@mirai-kirei.jp',
      'shimizu-a@mirai-kirei.jp',
      'sugisue-r@mirai-kirei.jp',
      'koga-s@mirai-kirei.jp',
      'senami-y@mirai-kirei.jp',
      'fushimi-m@mirai-kirei.jp',
      'sato-s@mirai-kirei.jp',
      'ito-y@mirai-kirei.jp',
      'shimoji-t@mirai-kirei.jp',
      'kubota-s@mirai-kirei.jp',
      'sato-c@mirai-kirei.jp',
      'sakamoto-m@mirai-kirei.jp',
      'miyake-m@mirai-kirei.jp',
      'yamashita-k@mirai-kirei.jp',
      'yamamoto-y@mirai-kirei.jp',
      'oooke-y@mirai-kirei.jp',
      'hasebe-m@mirai-kirei.jp',
      'uchida-m@mirai-kirei.jp',
      'kusumi-m@mirai-kirei.jp',
      'hiratani-r@mirai-kirei.jp',
      'hirata-k@mirai-kirei.jp',
      'hayashi-a@mirai-kirei.jp',
      'suzuki-y@mirai-kirei.jp'
    ],
    
    // メールアドレスから担当者名へのマッピング
    EMAIL_TO_NAME: {
      'mtanaka@mirai-kirei.jp': '田中穂',
      'nakamura-h@mirai-kirei.jp': '中村等志',
      'kawamoto-y@mirai-kirei.jp': '河本佑太',
      'okumura-h@mirai-kirei.jp': '奥村隼与',
      'majima-t@mirai-kirei.jp': '眞島拓海',
      'takano-r@mirai-kirei.jp': '高野涼士',
      'hashimoto-k@mirai-kirei.jp': '橋本幹太',
      'maeno-a@mirai-kirei.jp': '前野綾樹',
      'tani-s@mirai-kirei.jp': '谷颯真',
      'ibi-h@mirai-kirei.jp': '井比博',
      'yoshida-k@mirai-kirei.jp': '吉田紀久子',
      'yoshida-m@mirai-kirei.jp': '吉田萌',
      'miyazawa-r@mirai-kirei.jp': '宮沢麗子',
      'koike-m@mirai-kirei.jp': '小池勝也',
      'ono-h@mirai-kirei.jp': '小野秀明',
      'hirata-y@mirai-kirei.jp': '平田佑香',
      'yyamada@mirai-kirei.jp': '山田善丈',
      'yokoyama-s@mirai-kirei.jp': '横山颯',
      'shibuya-s@mirai-kirei.jp': '澁谷悟',
      'arayashiki-r@mirai-kirei.jp': '荒屋敷陸斗',
      'taishisuzuki@mirai-kirei.jp': '鈴木太志',
      'takahashi-r@mirai-kirei.jp': '髙橋諒太',
      'soda-c@mirai-kirei.jp': '宗田ちづる',
      'shimizu-a@mirai-kirei.jp': '清水あす香',
      'sugisue-r@mirai-kirei.jp': '杉末莉沙',
      'koga-s@mirai-kirei.jp': '古賀周子',
      'senami-y@mirai-kirei.jp': '瀬並裕美子',
      'fushimi-m@mirai-kirei.jp': '伏見真央',
      'sato-s@mirai-kirei.jp': '佐藤翔子',
      'ito-y@mirai-kirei.jp': '伊東由貴子',
      'shimoji-t@mirai-kirei.jp': '下地つばさ',
      'kubota-s@mirai-kirei.jp': '久保田沙希',
      'sato-c@mirai-kirei.jp': '佐藤千恵',
      'sakamoto-m@mirai-kirei.jp': '坂元萌子',
      'miyake-m@mirai-kirei.jp': '三宅萌',
      'yamashita-k@mirai-kirei.jp': '山下和美',
      'yamamoto-y@mirai-kirei.jp': '山本由夏',
      'oooke-y@mirai-kirei.jp': '大桶百合子',
      'hasebe-m@mirai-kirei.jp': '長谷部まりえ',
      'uchida-m@mirai-kirei.jp': '内田萌恵',
      'kusumi-m@mirai-kirei.jp': '楠美美有紀',
      'hiratani-r@mirai-kirei.jp': '平谷里砂',
      'hirata-k@mirai-kirei.jp': '平田華奈子',
      'hayashi-a@mirai-kirei.jp': '林梓',
      'suzuki-y@mirai-kirei.jp': '鈴木由佳理'
    },
    
    // 担当者から除外したいメールアドレス（例: 代理カレンダー）
    EXCLUDED_RESPONSIBLE_EMAILS: [
      'ibi-h@mirai-kirei.jp'
    ],
    
    // ============================================
    // MKシステム設定
    // ============================================
    
    MK_SYSTEM: {
      // MKシステムのAPIエンドポイント
      API_ENDPOINT: 'https://mk-system.example.com/api/meetings',
      
      // APIキーまたは認証トークン
      // 注意: 本番環境ではScript Propertiesを使用することを推奨
      API_KEY: 'your-api-key-here',
      
      // 認証方法のタイプ（'bearer' または 'apikey'）
      AUTH_TYPE: 'bearer',
      
      // 追加のリクエストヘッダー
      ADDITIONAL_HEADERS: {
        // 'X-Custom-Header': 'value',
      },
      
      // 追加フィールド（MKシステムが要求する場合）
      ADDITIONAL_FIELDS: {
        // 'department': 'マーケティング部',
        // 'category': 'クライアントミーティング',
        // 'status': 'scheduled',
      },
      
      // フィールドマッピング（カレンダーのデータをMKシステムのフィールド名に変換）
      // 空のオブジェクトの場合は、デフォルトのフィールド名を使用します
      // MKシステムのAPI仕様に合わせて調整してください
      FIELD_MAPPING: {
        // 例:
        // 'date': 'meeting_date',
        // 'client_name': 'client',
        // 'responsible_person': 'responsible',
        // 'title': 'title',
        // 'description': 'notes',
      }
    },
    
    // MKシステムの手動登録状況を管理しているスプレッドシート
    MK_REGISTRATION_SHEET: {
      // MKシステムで登録済みの議事録を記録しているスプレッドシートのID
      SPREADSHEET_ID: '',
      // GASがアクセスできる同一スプレッドシート内に手動貼り付けする場合のシート名
      LOCAL_SHEET_NAME: 'MK登録済み一覧',
      // 外部スプレッドシートを参照する場合のシート名
      SHEET_NAME: 'MK議事録',
      // ヘッダー名（手動登録シート側）の指定
      DATE_COLUMN: '日付',
      START_TIME_COLUMN: '開始時刻',
      EMAIL_COLUMN: '担当者メールアドレス',
      // ステータス欄に表示する値（例: 済）
      STATUS_VALUE: '済'
    },
    
    // ============================================
    // スプレッドシート設定
    // ============================================
    
    // スプレッドシートID（空の場合は自動的に新しいスプレッドシートを作成）
    // 既存のスプレッドシートを使用する場合、URLからIDを取得してください
    // 例: https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit
    SPREADSHEET_ID: '1d_7Tq1m5TLoejzaTAW3woPGv4KSf4_ONIyL3ufFPwhI',
    
    // スプレッドシート名（新規作成時に使用）
    SPREADSHEET_NAME: '議事録一覧',
    
    // スプレッドシートのシート名
    SHEET_NAME: '議事録',
    // MKシステムへの登録状況を表示する列のヘッダー
    REGISTRATION_STATUS_HEADER: 'MK登録状況',
    // 担当者メールアドレス列のヘッダー
    RESPONSIBLE_EMAIL_HEADER: '担当者メールアドレス',
    // 参加者列のヘッダー
    PARTICIPANT_HEADER: '参加者',
    // 場所列のヘッダー
    LOCATION_HEADER: '場所',
    
    // チャットワーク連携設定
    CHATWORK: {
      ENABLED: false, // trueにするとリマインド送信を有効化
      API_TOKEN: "your-chatwork-api-token",
      ROOM_ID: "138351493",
      REMINDER_TEMPLATE: "[info][title]MKシステム未登録の議事録[/title]%DETAILS%[/info]"
    },
    
    // ============================================
    // その他の設定
    // ============================================
    
    // タイムゾーン
    TIMEZONE: 'Asia/Tokyo',
    
    // ログ出力レベル（'INFO', 'WARNING', 'ERROR'）
    LOG_LEVEL: 'INFO',
    
    // テストモード（trueの場合、実際にMKシステムに登録しない）
    TEST_MODE: false
  };
}

/**
 * セキュアな設定（Script Propertiesを使用）
 * APIキーなどの機密情報はScript Propertiesに保存することを推奨
 */
function getSecureConfig() {
  const properties = PropertiesService.getScriptProperties();
  
  return {
    MK_SYSTEM: {
      API_ENDPOINT: properties.getProperty('MK_API_ENDPOINT') || getConfig().MK_SYSTEM.API_ENDPOINT,
      API_KEY: properties.getProperty('MK_API_KEY') || getConfig().MK_SYSTEM.API_KEY,
    }
  };
}

/**
 * Script Propertiesの設定方法：
 * 
 * 1. GASエディタで「プロジェクトの設定」→「スクリプト プロパティ」を開く
 * 2. 以下のプロパティを追加：
 *    - MK_API_ENDPOINT: MKシステムのAPIエンドポイント
 *    - MK_API_KEY: MKシステムのAPIキー
 */

